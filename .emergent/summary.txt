<analysis>**original_problem_statement:**
The user's goal is to build a comprehensive, feature-rich admin panel for a casino operation. The primary focus is on expanding the Game Management module, implementing a multi-tenant architecture, robust user authentication (RBAC), and automation tools like a Game Robot.

**PRODUCT REQUIREMENTS (V1 Definition):**
*   **P0-A: Crash & Dice Advanced Config Finalization (COMPLETED):** Fully implement, test (E2E), and document Advanced Safety for Crash and Advanced Limits for Dice.
*   **P0-B: Slot Config Finalization (COMPLETED):** Ensure all Slot configuration tabs have a working E2E data round-trip.
*   **P0-C: Minimum Version Diff Visibility (COMPLETED):** Implement a UI to show which configuration fields have changed between versions.
*   **P0-D: Test Game Inventory (COMPLETED):** Ensure at least one test game exists for each core game type.
*   **P0-E: Game Robot (MVP) (COMPLETED):** Create a minimal, script-based Game Robot to simulate gameplay on test games (Slot, Crash, Dice).
*   **P0-F: Unity Integration Checklist (UPCOMING):** Create a markdown document for integrating a Unity game.
*   **P0-G: Admin Panel Runbook (UPCOMING):** Write a  (user manual) for operators.
*   **P1: Hardening (DEFINED):** Define and validate a suite of negative edge-case tests.
*   **NEW: FAZ 1/2/3... (Productization):** Implement multi-tenancy, granular RBAC, API key management, and full admin authentication.

**User's preferred language**: **Turkish**. The next agent MUST respond in Turkish.

**what currently exists?**
A full-stack application (React/FastAPI/MongoDB) with a Game Management module. Recent work has added significant new functionality:
- **Game Robot:** A script () exists to simulate gameplay on test games. It is now tenant-aware.
- **Client-Aware Imports:** A full-stack flow allows uploading and managing game clients (HTML5 vs. Unity), with dedicated backend models (), a new upload endpoint, and a frontend wizard.
- **New Member Bonus:** A New Member Manual Bonus feature is fully implemented, including backend configuration models, GET/PUT endpoints, and a trigger mechanism that grants bonuses to new users. The frontend has a dedicated card in the Bonus Management section to configure this.
- **Multi-Tenancy (Backend):** A  model (/ types, feature flags) and  endpoints are in place. Key data endpoints (, , ) now filter by tenant. A feature guard helper () has been implemented to restrict access based on tenant features.
- **Multi-Tenancy (Frontend):** A  hook and a  have been created. The main layout () now conditionally renders menu items based on the tenant type (owner vs. renter).

**Last working item**:
    - **Last item agent was working:** The agent was given a detailed roadmap and greenlit to begin implementation. The user approved the plan to start with **Görev 3 (RBAC - Role & Yetki Yönetimi)**, to be followed by **Görev 3b (Admin Auth & Şifre Yönetimi)**. The last user message was uygula (apply/implement), confirming this plan.
    - **Status:** NOT STARTED
    - **Agent Testing Done:** N/A
    - **Which testing method agent to use?** Both (backend testing agent for APIs, frontend testing agent for UI flows). This is a large, critical feature.
    - **User Testing Done:** N

**All Pending/In progress Issue list**:
  - **Issue 1: ESLint warnings (P2)**
    - **Description:**  warnings persist across several frontend components. This is a low-priority technical debt item that does not block functionality.
    - **Status:** NOT STARTED
    - **Is recurring issue?** Y

**In progress Task List**:
- None.

**Upcoming and Future Tasks**
*   **Upcoming Tasks (P0, Highest Priority):**
    *   **Görev 3: RBAC (Rol & Yetki Yönetimi):** Implement a flexible Role-Based Access Control system.
        *   **Backend:** Create  model, a  constant list, Role CRUD endpoints, and a  helper to guard routes.
        *   **Frontend:** Create a Roller (Roles) management page with a creation form and permission checkboxes. Integrate role selection into the Admin Users page.
    *   **Görev 3b: Admin Auth & Şifre Yönetimi:** Replace the dummy admin with a full authentication system.
        *   **Auth Method:** JWT (Bearer token) with frontend storage.
        *   **Password Policy:** Min. 8 chars, >=1 uppercase, >=1 number, >=1 special character.
        *   **Backend:** Update  model (, etc.). Create all necessary auth endpoints (, , , ). Update the admin creation flow to support manual password and invite link modes.
        - **Frontend:** Create login, change password, forgot password, and reset password pages.
    *   **Görev 4: API Anahtarları (API Keys):** Implement a system for generating and managing scoped API keys, and integrate it with the Game Robot.
    *   **Görev 5: Dokümantasyon (TR + EN + PDF):** Create comprehensive user manuals and technical checklists in Turkish and English, with PDF export capability.

*   **Future Tasks (Backlog):**
    *   P0-F: Unity Integration Checklist (creation failed, still pending).
    *   P0-G: Admin Panel Runbook ( was updated but a full runbook is pending).
    *   P1 - Enable Hardening Bot.
    *   Implement Blackjack/Poker Diff API.
    *   Refactor the large  and  files.
    *   Player Management Overhaul.
    *   Tenant-branding (logo, colors).

**Completed work in this session**
- **Görev 1 - Yeni Üye Manuel Bonus:** Implemented a full-stack feature for configuring and automatically triggering a manual bonus for new members.
- **Görev 2 - Kiracı Yetkisi (Tenant / Renter Modeli):**
  - **Backend (2.1, 2.2):** Implemented a multi-tenant architecture with  models, feature flags, data filtering on core endpoints, and a tenant-aware Game Robot.
  - **Frontend (2.3):** Created a  for owner admins to manage tenants and updated the main layout to show/hide menus based on tenant type.
- **Client-Aware Game Imports:** Added a full-stack flow to distinguish between HTML5 and Unity game clients during the import and upload process.

**Earlier issues found/mentioned but not fixed**
   - **Jackpots Diff UI Integration:** The generic  has not been integrated into a Jackpots history view, as no such UI view exists yet.
   - **Manual Game Import expansion:** While client-awareness was added, a broader expansion to handle all config types is unstarted.
   - **Player Management Overhaul:** Unstarted.

**Known issue recurrence from previous fork**
  - **Fragile :** This large file continues to grow, making it a prime candidate for refactoring into smaller, more focused routers.

**Code Architecture**


**Key Technical Concepts**
- **Multi-Tenancy:** The application now supports  and  tenants. Data access is filtered by , and feature access is controlled by a  dictionary on the  model.
- **Feature Guarding:** A backend helper () protects endpoints, raising a 403 error if a tenant's feature flag is disabled.
- **Event-Driven Bonus Trigger:** A New Member Bonus is granted via event endpoints (, ), which call an idempotent trigger function.
- **Client-Aware Asset Management:** The system can distinguish between  and  game clients during upload and stores this information in the  model's  field.

**key DB schema**
  - ** (NEW):** 
  - **:** Now stores  configuration.
  - **, , :** Now have a  field for data segregation.
  - **:** Updated to include . Will be further extended for RBAC and Auth.

**changes in tech stack**
  -  will be added as a backend dependency for password hashing.

**All files of reference**
-  (New Tenant model)
-  (New Tenant API)
-  (Tenant ID helper)
-  (Feature guard helper)
-  (Heavily modified for filtering and bonus trigger)
-  (Modified to be tenant-aware)
-  (New Tenant management UI)
-  (Modified for conditional menu rendering)
-  (New Bonus UI)

**Areas that need refactoring**:
-  is critically large.
-  is also becoming bloated with bonus triggers and various list endpoints. It should be split into smaller, domain-specific routers (e.g., , ).

**key api endpoints**
- 
- 
- 
- 
- 
- 
-  (Modified to be client-aware)

**Critical Info for New Agent**
- **You MUST interact with the user exclusively in Turkish.**
- The project is being developed in phases. Faz 1 (Bonus) and Faz 2 (Tenant Model) are now complete.
- The next set of tasks are **Görev 3 (RBAC)** and **Görev 3b (Admin Auth & Şifre Yönetimi)**. These are the highest priorities.
- The user has approved a **JWT-based** authentication model.
- The password policy is strict: **min. 8 characters, >=1 uppercase, >=1 number, >=1 special character.**
- Start by implementing the RBAC backend, then the Admin Auth backend, before moving to the frontend UI for both.

**documents created in this job**
  - None. Attempts to create  failed due to tool usage errors. This remains a pending task.

**Last 10 User Messages and any pending user messages**
- The user has been providing extremely detailed, multi-part Görev (Task) definitions.
- The last several messages confirmed the roadmap, approved the plan for RBAC and Admin Auth, and provided the final uygula (apply) command to start work. There are no pending user questions.

**Project Health Check:**
- **Healthy:** Core features are functional and tested.
- **Broken:** None.
- **Mocked:** The  context is still mocked. The next major task (Admin Auth) will replace this.

**3rd Party Integrations**
- **OpenAI GPT-4o:** Used for fraud detection risk analysis via . Uses Emergent LLM Key.
- **recharts:** Used for data visualization.
- **bcrypt:** To be added for password hashing.

**Testing status**
  - **Testing agent used after significant changes:** YES.  and  were used extensively for the Bonus, Tenant, and Client-Aware features.
  - **Troubleshoot agent used after agent stuck in loop:** NO.
  - **Test files created:** None. Test execution was done via sub-agents interpreting test plans.
  - **Known regressions:** None.

**Credentials to test flow:**
- None currently. After the Admin Auth task, new credentials will need to be created and used.

**What agent forgot to execute**
- The entire Admin Authentication flow (Görev 3b / FAZ X) was not implemented and was brought up by the user. It is now the next major priority after RBAC.
- The creation of  failed and was not corrected.</analysis>
